# Автоматическая очистка тестовых данных и организация в подпапки

## Обзор

Система автоматической очистки тестовых данных и организации их в подпапки предназначена для улучшения структуры директории результатов проекта. Эта система автоматически:

1. Организует существующие файлы в соответствующие подпапки на основе их типа
2. Очищает старые тестовые данные для экономии места
3. Удаляет пустые директории для поддержания чистоты файловой структуры
4. Предоставляет статистику по тестовым и реальным данным

## Структура директорий

После применения системы все данные в директории `результаты` будут организованы следующим образом:

```
результаты/
├── тестовые_данные/          # Все тестовые данные
└── реальные_данные/          # Все реальные данные
```

Пустые директории автоматически удаляются для поддержания чистоты структуры.

## Классификация файлов

Файлы классифицируются по следующим правилам:

### Тестовые данные
Файлы, которые содержат следующие ключевые слова в названии:
- `test` (в любом регистре)
- `тест`
- `fish_batch_test_results`
- `оптимизация`
- И другие подобные паттерны

### Реальные данные
Файлы, которые содержат следующие ключевые слова в названии:
- `b3ded820-4385-4a42-abc7-75dc0756d335` (уникальный идентификатор реальных данных)
- `вся номенклатура`

### Неопределенные данные
Файлы, которые не соответствуют ни одному из вышеуказанных паттернов, классифицируются на основе времени создания:
- Если файл создан менее 24 часов назад - считается тестовым
- Если файл создан более 24 часов назад - считается реальным

## Использование

### Автоматическая организация
Для автоматической организации существующих файлов запустите скрипт:

```bash
python scripts/organize_test_data.py
```

### Ручная организация
Вы также можете использовать менеджер тестовых данных программно:

```python
from src.core.test_data_manager import TestDataManager

# Создаем менеджер
manager = TestDataManager("результаты")

# Организуем существующие файлы
manager.organize_existing_files()

# Очищаем старые тестовые данные (по умолчанию старше 7 дней)
manager.cleanup_old_test_data()

# Удаляем пустые директории
manager._remove_empty_directories()

# Получаем статистику
stats = manager.get_test_data_stats()
print(f"Тестовых файлов: {stats['test_files_count']}")
print(f"Реальных файлов: {stats['real_files_count']}")
```

## Настройка

Вы можете настроить поведение системы, изменяя параметры в конструкторе TestDataManager:

```python
# Очистка файлов старше 30 дней
manager.cleanup_old_test_data(days_old=30)

# Использование другой директории результатов
manager = TestDataManager("мои_результаты")
```

## Преимущества

1. **Улучшенная организация** - все данные структурированы по типам
2. **Экономия места** - автоматическая очистка старых тестовых данных
3. **Чистота структуры** - автоматическое удаление пустых директорий
4. **Простота навигации** - легче находить нужные файлы
5. **Автоматизация** - минимальное вмешательство пользователя требуется
6. **Статистика** - возможность отслеживания объема данных

## Расширение функциональности

Для добавления новых паттернов классификации отредактируйте файл `src/core/test_data_manager.py`:

```python
# Список файлов, которые точно являются тестовыми
test_patterns = [
    "*test*",
    "*_тест_*",
    "test_*",
    "*_test_*",
    "*fish_batch_test_results*",
    "*_оптимизация_*"
    # Добавьте сюда новые паттерны
]

# Список файлов, которые точно являются реальными данными
real_patterns = [
    "*b3ded820-4385-4a42-abc7-75dc0756d335*",
    "*вся номенклатура*"
    # Добавьте сюда новые паттерны
]
```