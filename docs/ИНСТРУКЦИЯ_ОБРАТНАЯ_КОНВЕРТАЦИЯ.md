# ИНСТРУКЦИЯ ПО ИСПОЛЬЗОВАНИЮ
## Обратная конвертация из JSON в Excel

### 1. ВВЕДЕНИЕ

В систему встроена возможность восстанавливать иерархические Excel-файлы из канонического формата JSON. Это позволяет просматривать структурированные данные в привычном табличном редакторе.

### 2. ОСНОВНАЯ ФУНКЦИЯ

Для конвертации используется функция `json_to_excel` из модуля `excel_hierarchy_preserver`.

```python
from src.core.excel_hierarchy_preserver import json_to_excel

# Преобразование JSON в Excel
json_to_excel("структура.json", "восстановленный_отчет.xlsx")
```

### 3. ПРИМЕР ИСПОЛЬЗОВАНИЯ

#### Полный цикл преобразования (Excel -> JSON -> Excel)
```python
from src.core.excel_hierarchy_preserver import ExcelHierarchyPreserver, json_to_excel

# 1. Преобразование исходного Excel в JSON
preserver = ExcelHierarchyPreserver("оригинал.xlsx")
preserver.to_json("промежуточный.json")

# 2. Обратная конвертация из JSON в Excel
json_to_excel("промежуточный.json", "восстановленный.xlsx")
```

### 4. ТЕСТИРОВАНИЕ

Функциональность обратной конвертации проверяется в файле `test_reverse_conversion.py`. Тесты гарантируют, что структура данных (листы, строки, значения) в восстановленном файле соответствует исходной.

### 5. ДОКУМЕНТАЦИЯ

- **[СОХРАНЕНИЕ_ИЕРАРХИИ_EXCEL.md](СОХРАНЕНИЕ_ИЕРАРХИИ_EXCEL.md)**: Полное описание возможностей сохранения и восстановления иерархии.
- **[excel_hierarchy_preserver.py](excel_hierarchy_preserver.py)**: Исходный код функции `json_to_excel`.
