# üìñ –ö—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ Excel —Ñ–∞–π–ª–æ–≤

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ Excel –≤ JSON —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏:

```python
from src.core.excel_hierarchy_preserver import ExcelHierarchyPreserver

# –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Excel —Ñ–∞–π–ª–æ–º
preserver = ExcelHierarchyPreserver("–∏—Å—Ö–æ–¥–Ω—ã–π_—Ñ–∞–π–ª.xlsx")

# –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ JSON —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤—Å–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
preserver.to_json("—Ä–µ–∑—É–ª—å—Ç–∞—Ç.json")
```

### 2. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ JSON –æ–±—Ä–∞—Ç–Ω–æ –≤ Excel —Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏:

```python
from src.core.excel_hierarchy_preserver import json_to_excel

# –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º JSON –æ–±—Ä–∞—Ç–Ω–æ –≤ Excel —Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
json_to_excel("—Ä–µ–∑—É–ª—å—Ç–∞—Ç.json", "–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π_—Ñ–∞–π–ª.xlsx")
```

## üßæ –ß—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

### –ü—Ä–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ Excel ‚Üí JSON —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è:
- ‚úÖ –î–∞–Ω–Ω—ã–µ —è—á–µ–µ–∫ –≤—Å–µ—Ö –ª–∏—Å—Ç–æ–≤
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–∏—Å—Ç–æ–≤ (–∏–º–µ–Ω–∞, –ø–æ—Ä—è–¥–æ–∫)
- ‚úÖ **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å—Ç—Ä–æ–∫ –∏ —Å—Ç–æ–ª–±—Ü–æ–≤** ‚≠ê –ù–û–í–û–ï
- ‚úÖ **–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–≤–µ—Ä–Ω—É—Ç–æ—Å—Ç–∏/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ—Å—Ç–∏ –≥—Ä—É–ø–ø** ‚≠ê –ù–û–í–û–ï

### –ü—Ä–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ JSON ‚Üí Excel –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è:
- ‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —è—á–µ–µ–∫
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–∏—Å—Ç–æ–≤
- ‚úÖ **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å—Ç—Ä–æ–∫ –∏ —Å—Ç–æ–ª–±—Ü–æ–≤** ‚≠ê –ù–û–í–û–ï
- ‚úÖ **–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–≤–µ—Ä–Ω—É—Ç–æ—Å—Ç–∏/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ—Å—Ç–∏ –≥—Ä—É–ø–ø** ‚≠ê –ù–û–í–û–ï

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
python tests/test_grouping_preservation.py

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞
python -m pytest tests/ -v
```

## üìÅ –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã JSON —Ñ–∞–π–ª–∞

```json
{
  "source_file": "–∏—Å—Ö–æ–¥–Ω—ã–π_—Ñ–∞–π–ª.xlsx",
  "sheet_count": 2,
  "sheets": {
    "–õ–∏—Å—Ç1": [
      ["A1", "B1", "C1"],
      ["A2", "B2", "C2"]
    ],
    "–õ–∏—Å—Ç2": [
      ["D1", "E1", "F1"],
      ["D2", "E2", "F2"]
    ]
  },
  "grouping_info": {
    "–õ–∏—Å—Ç1": {
      "row_outline_levels": {
        "2": -1,  // –°—Ç—Ä–æ–∫–∞ 2 —Å–≤–µ—Ä–Ω—É—Ç–∞ (—É—Ä–æ–≤–µ–Ω—å 1)
        "3": 1    // –°—Ç—Ä–æ–∫–∞ 3 —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞ (—É—Ä–æ–≤–µ–Ω—å 1)
      },
      "column_outline_levels": {
        "B": -2,  // –°—Ç–æ–ª–±–µ—Ü B —Å–≤–µ—Ä–Ω—É—Ç (—É—Ä–æ–≤–µ–Ω—å 2)
        "C": 2    // –°—Ç–æ–ª–±–µ—Ü C —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç (—É—Ä–æ–≤–µ–Ω—å 2)
      }
    }
  }
}
```

## üí° –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ü–æ–ª–Ω–∞—è –æ–±—Ä–∞—Ç–∏–º–æ—Å—Ç—å** - –ú–æ–∂–Ω–æ —Ç–æ—á–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª
2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã** - –í—Å–µ –∞—Å–ø–µ–∫—Ç—ã Excel —Ñ–∞–π–ª–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
3. **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** - –¢–µ –∂–µ —Å–∞–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –Ω–æ —Å –Ω–æ–≤—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏
4. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ù–û–í–û–ï: –ú–µ—Ç–æ–¥ `_extract_grouping_info()`
–ò–∑–≤–ª–µ–∫–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–µ –∏–∑ –ª–∏—Å—Ç–∞ Excel —Ñ–∞–π–ª–∞:
- –£—Ä–æ–≤–Ω–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Å—Ç—Ä–æ–∫ –∏ —Å—Ç–æ–ª–±—Ü–æ–≤
- –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–≤–µ—Ä–Ω—É—Ç–æ—Å—Ç–∏/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ—Å—Ç–∏

### –ù–û–í–û–ï: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ JSON
–î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª `grouping_info` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–µ.

## ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–¢–µ–ø–µ—Ä—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É Excel —Ñ–∞–π–ª–æ–≤, –≤–∫–ª—é—á–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É —Å—Ç—Ä–æ–∫ –∏ —Å—Ç–æ–ª–±—Ü–æ–≤!