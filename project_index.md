# Индекс файлов проекта "Расчет коэффициентов нелинейной усушки и предварительный расчет усушки"

## Структура проекта

```
расчет коэффициентов нелинейной усушки, и предварительный расчет усушки 1.1/
├── документация/
├── исходные_данные/
│   ├── Для_расчета_коэфф/
│   │   ├── 14,07,25- 21.07.25.pdf
│   │   ├── b3ded820-4385-4a42-abc7-75dc0756d335_6ba7ac50-fb1a-4bea-9489-265bdfdcb8d1_вся номенклатура за период с 15.07.25 по 21.07.25.xls
│   │   ├── sheet_1_Лист_1.csv
│   │   └── test_data.csv
│   └── Для_передварительной_усушки/
│       ├── 14,07,25- 21.07.25 Для предварительного расчета усушки.pdf
│       └── sheet_1_Лист_1_prelim.csv
├── результаты/
│   ├── Эталон HTML/
│   ├── детальное_сравнение_остатков_v2.csv
│   ├── детальное_сравнение_остатков.csv
│   ├── значительные_расхождения_остатков.csv
│   ├── коэффициенты_усушки_улучшенные.csv
│   ├── коэффициенты_усушки_улучшенные.html
│   ├── коэффициенты_усушки_улучшенные_modern.csv
│   ├── коэффициенты_усушки_улучшенные_modern.html
│   ├── необработанные_позиции.html
│   ├── предварительный_расчет_усушки.csv
│   ├── предварительный_расчет_усушки.html
│   ├── сравнение_остатков.csv
│   ├── сравнение_усушки.csv
│   ├── сравнение_усушки.html
│   ├── test_коэффициенты_усушки_улучшенные.csv
│   ├── test_коэффициенты_усушки_улучшенные.html
│   └── test_необработанные_позиции.html
├── скрипты/
│   ├── __pycache__/
│   ├── analytics.py
│   ├── analyze_duplicates.py
│   ├── compare_initial_balances.py
│   ├── compare_shrinkage.py
│   ├── config.json
│   ├── convert_pdf_to_csv_prelim.py
│   ├── correct_compare_balances.py
│   ├── csv_parser.py
│   ├── data_converter.py
│   ├── data_structure.py
│   ├── debug_calculator.py
│   ├── demo_modular_architecture.py
│   ├── detailed_balance_analysis.py
│   ├── detailed_compare_balances.py
│   ├── excel_parser.py
│   ├── file_watcher.py
│   ├── gui_tkinter.py
│   ├── improved_coefficient_calculator_modern.py
│   ├── improved_coefficient_calculator_new.py
│   ├── improved_coefficient_calculator.py
│   ├── manual_compare_balances.py
│   ├── pdf_parser.py
│   ├── pdf_to_csv_converter.py
│   ├── preliminary_shrinkage_calculator.py
│   ├── simple_compare_balances.py
│   ├── test_analytics.py
│   ├── test_clustering.py
│   ├── test_data.py
│   ├── test_modular_architecture.py
│   └── test_reports.py
├── backup_2025_08_20/
├── logs/
├── venv/
├── 1.txt
├── config.json
├── gemini_self_guide.md
├── MODERNIZATION_REPORT.md
├── PARSING_PLAN.md
├── project_index.md
├── README.md
├── requirements.txt
├── run_balance_comparison.bat
├── run_comparison.bat
├── run_demo_modular_architecture.bat
├── run_gui.bat
├── run_modern_calculator.bat
├── run_preliminary.bat
├── run_test.bat
└── run_test_modular_architecture.bat
```

## Описание ключевых файлов и папок

### Папки

- `исходные_данные/`: Содержит исходные отчеты и данные.
  - `Для_расчета_коэфф/`: Отчеты, используемые для расчета коэффициентов усушки.
    - `sheet_1_Лист_1.csv`: Основной отчет для расчета коэффициентов.
  - `Для_передварительной_усушки/`: Отчеты, используемые для предварительного расчета усушки.
    - `sheet_1_Лист_1_prelim.csv`: Основной отчет для предварительного расчета усушки.

- `результаты/`: Содержит все результаты работы скриптов.
  - `Эталон HTML/`: Папка для эталонных HTML-файлов.
  - `коэффициенты_усушки_улучшенные.csv/html`: Рассчитанные коэффициенты усушки (классическая версия).
  - `коэффициенты_усушки_улучшенные_modern.csv/html`: Рассчитанные коэффициенты усушки (современная версия).
  - `предварительный_расчет_усушки.csv/html`: Результаты предварительного расчета усушки.
  - `сравнение_усушки.csv/html`: Сравнение результатов предварительного расчета и фактической усушки.
  - `сравнение_остатков.csv`: Сравнение начальных остатков из разных отчетов.

- `скрипты/`: Содержит все Python-скрипты проекта.
  - `analytics.py`: Модуль с функциями аналитики и прогнозирования.
  - `improved_coefficient_calculator.py`: Классический скрипт для расчета коэффициентов усушки.
  - `preliminary_shrinkage_calculator.py`: Скрипт для предварительного расчета усушки.
  - `compare_shrinkage.py`: Скрипт для сравнения результатов расчета усушки.
  - `compare_initial_balances.py`: Скрипт для сравнения начальных остатков.
  - `data_structure.py`: Новый модуль для определения и валидации унифицированной структуры данных.
  - `data_converter.py`: Новый модуль для преобразования данных в унифицированную структуру и обратно.
  - `csv_parser.py`: Новый модуль для парсинга CSV отчетов.
  - `excel_parser.py`: Новый модуль для парсинга Excel отчетов.
  - `pdf_parser.py`: Каркас для парсинга PDF отчетов.
  - `improved_coefficient_calculator_modern.py`: Современная версия скрипта для расчета коэффициентов усшки.
  - `demo_modular_architecture.py`: Демонстрационный скрипт для работы новой модульной архитектуры.
  - `test_modular_architecture.py`: Тестовый скрипт для проверки работы модульной архитектуры.

### Ключевые скрипты

1.  `improved_coefficient_calculator.py`:
    - **Назначение**: Расчет коэффициентов усушки (классическая версия).
    - **Входные данные**: `исходные_данные/Для_расчета_коэфф/sheet_1_Лист_1.csv`.
    - **Выходные данные**: `результаты/коэффициенты_усушки_улучшенные.csv`, `результаты/коэффициенты_усушки_улучшенные.html`, `результаты/необработанные_позиции.html`.
    - **Особенности**: Поддерживает параметр `--calculation_start_date`.

2.  `preliminary_shrinkage_calculator.py`:
    - **Назначение**: Предварительный расчет усушки.
    - **Входные данные**: `результаты/коэффициенты_усушки_улучшенные.csv`, `исходные_данные/Для_передварительной_усушки/sheet_1_Лист_1_prelim.csv`.
    - **Выходные данные**: `результаты/предварительный_расчет_усушки.csv`, `результаты/предварительный_расчет_усушки.html`.
    - **Особенности**: Поддерживает параметр `--calculation_start_date`.

3.  `compare_shrinkage.py`:
    - **Назначение**: Сравнение результатов предварительного расчета усшки с фактической усушкой.
    - **Входные данные**: `результаты/коэффициенты_усушки_улучшенные.csv`, `результаты/предварительный_расчет_усшки.csv`.
    - **Выходные данные**: `результаты/сравнение_усшки.csv`, `результаты/сравнение_усшки.html`.

4.  `compare_initial_balances.py`:
    - **Назначение**: Сравнение начальных остатков из разных отчетов.
    - **Входные данные**: `результаты/коэффициенты_усушки_улучшенные.csv`, `исходные_данные/Для_расчета_коэфф/sheet_1_Лист_1.csv`, `исходные_данные/Для_передварительной_усушки/sheet_1_Лист_1_prelim.csv`.
    - **Выходные данные**: `результаты/сравнение_остатков.csv`.

5.  `improved_coefficient_calculator_modern.py`:
    - **Назначение**: Современная версия скрипта для расчета коэффициентов усшки с модульной архитектурой.
    - **Входные данные**: Любой поддерживаемый формат файла с данными.
    - **Выходные данные**: `результаты/коэффициенты_усшки_улучшенные_modern.csv`, `результаты/коэффициенты_усшки_улучшенные_modern.html`.
    - **Особенности**: Использует унифицированную структуру данных, поддерживает различные форматы входных файлов.

6.  `data_structure.py`:
    - **Назначение**: Модуль для определения и валидации унифицированной структуры данных.
    - **Входные данные**: Унифицированная структура данных.
    - **Выходные данные**: Результаты валидации.

7.  `data_converter.py`:
    - **Назначение**: Модуль для преобразования данных в унифицированную структуру и обратно.
    - **Входные данные**: Различные форматы данных.
    - **Выходные данные**: Унифицированная структура данных или CSV файлы.

8.  `csv_parser.py`:
    - **Назначение**: Модуль для парсинга CSV отчетов.
    - **Входные данные**: CSV файл с отчетом о товародвижении.
    - **Выходные данные**: Унифицированная структура данных.

9.  `excel_parser.py`:
    - **Назначение**: Модуль для парсинга Excel отчетов.
    - **Входные данные**: Excel файл с отчетом о товародвижении.
    - **Выходные данные**: Унифицированная структура данных.

10. `pdf_parser.py`:
    - **Назначение**: Каркас для парсинга PDF отчетов.
    - **Входные данные**: PDF файл с отчетом о товародвижении.
    - **Выходные данные**: Унифицированная структура данных.

11. `demo_modular_architecture.py`:
    - **Назначение**: Демонстрационный скрипт для работы новой модульной архитектуры.
    - **Входные данные**: Нет.
    - **Выходные данные**: Вывод информации о работе модулей.

12. `test_modular_architecture.py`:
    - **Назначение**: Тестовый скрипт для проверки работы модульной архитектуры.
    - **Входные данные**: Нет.
    - **Выходные данные**: Результаты тестирования.

### Bat-скрипты

1.  `run_gui.bat`: Запуск графического интерфейса.
2.  `run_test.bat`: Запуск скрипта в тестовом режиме.
3.  `run_preliminary.bat`: Запуск предварительного расчета усшки.
4.  `run_comparison.bat`: Запуск сравнения результатов расчета усшки.
5.  `run_balance_comparison.bat`: Запуск сравнения начальных остатков.
6.  `run_modern_calculator.bat`: Запуск современной версии калькулятора коэффициентов усшки.
7.  `run_demo_modular_architecture.bat`: Запуск демонстрации модульной архитектуры.
8.  `run_test_modular_architecture.bat`: Запуск тестирования модульной архитектуры.

### Документация

1.  `README.md`: Основной файл документации проекта.
2.  `project_index.md`: Этот файл - индекс проекта.
3.  `gemini_self_guide.md`: Руководство для Qwen Code по работе с проектом.
4.  `PARSING_PLAN.md`: План разделения парсинга и преобразования в CSV формат.
5.  `MODERNIZATION_REPORT.md`: Отчет о модернизации проекта.
6.  `1.txt`: Краткий отчет о проделанной работе.

### Конфигурационные файлы

1.  `config.json`: Конфигурационный файл проекта.
2.  `requirements.txt`: Зависимости проекта.

## План развития проекта

1.  **Завершение разработки PDF парсера** (`pdf_parser.py`).
2.  **Завершение разработки Excel парсера** (`excel_parser.py`).
3.  **Завершение разработки CSV парсера** (`csv_parser.py`).
4.  **Завершение интеграции модульной архитектуры** во все скрипты.
5.  **Создание единого интерфейса** для работы с различными форматами отчетов.
6.  **Расширение функциональности** системы (графический интерфейс, экспорт результатов и т.д.).