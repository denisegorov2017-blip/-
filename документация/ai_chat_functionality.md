# Функция ИИ-чата в графических интерфейсах

## Обзор

Система включает встроенный ИИ-чат для помощи пользователям в работе с системой расчета коэффициентов усушки. ИИ-чат предоставляет информацию о работе системы, подготовке данных, интерпретации результатов и решении технических проблем.

## Реализация в GUI

### Tkinter GUI

В Tkinter GUI ИИ-чат реализован в отдельной вкладке интерфейса:

1. Вкладка "ИИ-чат" содержит историю разговора и поле для ввода вопросов
2. Кнопка "Отправить" отправляет вопрос в ИИ и отображает ответ
3. Кнопка "Очистить" очищает историю чата
4. Кнопка "Настройки ИИ" открывает диалог настроек внешних ИИ сервисов

#### Особенности реализации:
- История чата сохраняется в файл `результаты/ai_chat_history.json`
- Настройки ИИ сохраняются в файл `результаты/ai_chat_settings.json`
- Поддержка как встроенного ИИ, так и внешних ИИ сервисов (OpenAI, Claude и др.)

### Flet GUI

В Flet GUI ИИ-чат реализован в нижней части основного интерфейса:

1. Область чата отображает историю разговора
2. Поле ввода позволяет задавать вопросы ИИ
3. Кнопка отправки сообщения
4. Кнопка очистки чата
5. Кнопка настроек ИИ в заголовке интерфейса

#### Особенности реализации:
- История чата сохраняется в файл `результаты/ai_chat_history.json`
- Настройки ИИ сохраняются в файл `результаты/ai_chat_settings.json`
- Поддержка как встроенного ИИ, так и внешних ИИ сервисов

## Встроенный ИИ

Встроенный ИИ предоставляет ответы на основе ключевых слов в вопросах пользователя:

### Поддерживаемые темы:
1. Приветствия и общие вопросы о помощи
2. Работа с данными инвентаризации
3. Расчет коэффициентов усушки
4. Подготовка данных Excel
5. Точность расчетов и верификация
6. Общие вопросы о системе

### Примеры вопросов:
- "Как работает система расчета коэффициентов усушки?"
- "Что такое инвентаризация?"
- "Какие данные нужны для расчета?"
- "Как интерпретировать точность расчетов?"

## Внешние ИИ сервисы

Система поддерживает подключение внешних ИИ сервисов через API:

### Поддерживаемые сервисы:
1. OpenAI (GPT-3.5, GPT-4)
2. Claude (Anthropic)
3. Другие совместимые сервисы

### Настройка внешнего ИИ:
1. Включить использование внешнего ИИ в настройках
2. Ввести действующий API ключ
3. Выбрать модель ИИ
4. При необходимости изменить базовый URL API

### Требования к внешним сервисам:
- Совместимость с OpenAI API
- Действующий API ключ
- Доступ к интернету

## Техническая реализация

### В ядре системы
Функция реализована в классе [AIChat](file:///c%3A/Users/D_909/Desktop/%D0%B4%D0%BB%D1%8F%20%D0%BD%D0%BE%D0%B2%D0%BE%D0%B3%D0%BE%20%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0/src/core/ai_chat.py#L27-L271) в модуле `src/core/ai_chat.py`:

```python
class AIChat:
    def __init__(self, config: Optional[Dict[str, Any]] = None):
        # Инициализация чата с настройками
        
    def get_response(self, user_message: str) -> str:
        # Получение ответа от ИИ
        
    def get_external_ai_response(self, user_message: str) -> str:
        # Получение ответа от внешнего ИИ
```

### В графических интерфейсах
Оба GUI используют общий класс `AIChat` для работы с ИИ-чатом.

## Рекомендации для пользователей

1. **Используйте встроенный ИИ для общих вопросов** - он работает без подключения к интернету
2. **Подключайте внешний ИИ для сложных запросов** - более мощные модели могут дать более точные ответы
3. **Сохраняйте историю чата** - она может быть полезна для обучения системы
4. **Регулярно обновляйте API ключи** - для обеспечения безопасности