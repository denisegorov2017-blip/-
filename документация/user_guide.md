# Руководство пользователя системы расчета усушки

## Введение

Это руководство поможет вам эффективно использовать систему расчета коэффициентов нелинейной усушки для анализа и прогнозирования усушки продукции.

## Требования к системе

### Минимальные требования
- Операционная система: Windows 10/11, macOS 10.15+, или Linux
- Python 3.9 или выше
- 4 ГБ оперативной памяти
- 100 МБ свободного места на диске

### Рекомендуемые требования
- Операционная система: Windows 11, macOS 12+, или Linux (современный дистрибутив)
- Python 3.11
- 8 ГБ оперативной памяти
- 1 ГБ свободного места на диске

## Установка и запуск

### Установка Python

Если Python еще не установлен:

1. Перейдите на [python.org](https://www.python.org/downloads/)
2. Скачайте последнюю версию Python 3.9 или выше
3. Установите с включенной опцией "Add to PATH"

### Установка системы

1. Распакуйте архив с системой в удобную директорию
2. Откройте командную строку/терминал в директории системы
3. Установите зависимости:

```bash
pip install -e .
```

### Запуск системы

Система предоставляет несколько способов взаимодействия:

#### 1. Через меню выбора интерфейса
```bash
python launch.py
```

#### 2. Через графический интерфейс Flet
```bash
python -m src.gui_complete
```

#### 3. Через графический интерфейс Tkinter
```bash
python src/tkinter_gui.py
```

#### 4. Через веб-дашборд Streamlit
```bash
streamlit run src/dashboard.py
```

#### 5. Через командную строку
```bash
python -m src.cli process данные.xlsx
```

## Подготовка данных

### Формат Excel файлов

Система поддерживает следующие форматы Excel:
- .xlsx (рекомендуется)
- .xls
- .xlsm

### Структура данных

Excel файл должен содержать следующие колонки:

1. **Номенклатура** - Наименование товара
2. **Дата прихода** - Дата поступления товара
3. **Дата инвентаризации** - Дата проведения инвентаризации
4. **Начальный остаток** - Количество товара на момент прихода
5. **Конечный остаток** - Количество товара на момент инвентаризации
6. **Единица измерения** - Единица измерения товара (кг, шт, л и т.д.)

### Пример структуры

| Номенклатура | Дата прихода | Дата инвентаризации | Начальный остаток | Конечный остаток | Единица измерения |
|--------------|--------------|---------------------|-------------------|------------------|-------------------|
| Рыба треска  | 01.01.2024   | 15.01.2024          | 1000              | 950              | кг                |
| Мясо говядина| 05.01.2024   | 20.01.2024          | 500               | 480              | кг                |

## Использование графических интерфейсов

### Flet GUI

1. Запустите Flet GUI: `python -m src.gui_complete`
2. Нажмите "Выбрать Excel файл" и выберите ваш файл данных
3. Настройте параметры расчета:
   - Включите "Использовать адаптивную модель расчета" для более точных результатов
   - При необходимости включите учет процента излишка
4. Нажмите "Рассчитать коэффициенты"
5. После завершения расчета нажмите "Открыть отчет" для просмотра результатов

### Tkinter GUI

1. Запустите Tkinter GUI: `python src/tkinter_gui.py`
2. Перейдите на вкладку "Основное"
3. Выберите файл данных и настройте параметры расчета
4. Нажмите "Рассчитать коэффициенты"
5. Используйте вкладку "Утилиты" для управления тестовыми данными
6. Вкладка "ИИ-чат" предоставляет помощь в работе с системой

### Streamlit Dashboard

1. Запустите дашборд: `streamlit run src/dashboard.py`
2. Загрузите файл данных через интерфейс дашборда
3. Просмотрите интерактивные графики и аналитику
4. Экспортируйте результаты при необходимости

## Использование командной строки

### Основные команды

```bash
# Обработка файла с настройками по умолчанию
python -m src.cli process данные.xlsx

# Обработка с адаптивной моделью
python -m src.cli process данные.xlsx --adaptive

# Обработка с учетом излишка 5%
python -m src.cli process данные.xlsx --surplus 5.0

# Открыть отчет после генерации
python -m src.cli process данные.xlsx --open

# Просмотр текущих настроек
python -m src.cli settings --list

# Сброс настроек к значениям по умолчанию
python -m src.cli settings --reset
```

### Параметры командной строки

#### process
- `file` - Путь к Excel файлу (обязательный)
- `--adaptive` - Использовать адаптивную модель
- `--surplus RATE` - Процент излишка (0-100)
- `--open` - Открыть отчет после генерации

#### settings
- `--list` - Показать текущие настройки
- `--reset` - Сбросить настройки к значениям по умолчанию
- `--backup` - Создать резервную копию настроек
- `--restore FILE` - Восстановить настройки из резервной копии

## Настройка системы

### Доступ к настройкам

В графических интерфейсах настройки доступны через меню "Настройки" или соответствующие кнопки.

### Категории настроек

#### 1. Общие настройки расчетов
- **Тип модели**: Выберите модель расчета (экспоненциальная, линейная, полиномиальная)
- **Период по умолчанию**: Количество дней для предварительных расчетов
- **Минимальная точность**: Порог точности для фильтрации результатов
- **Адаптивная модель**: Включение самообучающейся модели
- **Процент излишка**: Средний процент излишка при поступлении

#### 2. Настройки интерфейса
- **Тема**: Светлая, темная или системная тема
- **Язык**: Русский или английский язык интерфейса
- **Размер окна**: Ширина и высота окна приложения

#### 3. Настройки базы данных
- **Включение базы данных**: Использование базы данных для хранения результатов
- **URL подключения**: Параметры подключения к базе данных
- **Резервное копирование**: Настройки автоматического резервного копирования
- **Верификация**: Включение проверки коэффициентов

#### 4. Настройки вывода
- **Директория результатов**: Путь для сохранения отчетов
- **Автоматическое открытие**: Открывать отчеты сразу после генерации
- **Тема отчетов**: Визуальное оформление HTML отчетов

## Интерпретация результатов

### Основной отчет

Отчет содержит следующую информацию:

1. **Коэффициенты усушки** - Рассчитанные коэффициенты для каждой номенклатуры
2. **Точность расчета** - Процент точности прогноза
3. **Период хранения** - Количество дней между приходом и инвентаризацией
4. **Фактическая усушка** - Реальное количество усохшего товара
5. **Прогнозируемая усушка** - Расчетное количество усушки

### Графики и визуализации

- **Кривая усушки** - График изменения усушки во времени
- **Сравнение моделей** - Сравнение точности разных моделей расчета
- **Анализ точности** - Диаграмма точности по номенклатурам

## Решение проблем

### Частые ошибки

#### "Файл не найден"
- Проверьте путь к файлу
- Убедитесь, что файл не открыт в другом приложении

#### "Неверный формат данных"
- Проверьте структуру Excel файла
- Убедитесь, что все обязательные колонки присутствуют

#### "Ошибка подключения к базе данных"
- Проверьте настройки подключения
- Убедитесь, что база данных доступна

### Логи и отладка

Система сохраняет логи в директории [logs/](file:///c%3A/Users/D_909/Desktop/%D0%B4%D0%BB%D1%8F%20%D0%BD%D0%BE%D0%B2%D0%BE%D0%B3%D0%BE%20%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0/logs/). Для диагностики проблем:

1. Проверьте последние файлы логов
2. Обратите внимание на сообщения с уровнями ERROR и CRITICAL
3. При обращении в поддержку приложите последние логи

## Рекомендации по использованию

### Для максимальной точности

1. Используйте адаптивную модель расчета
2. Регулярно обновляйте данные инвентаризации
3. Учитывайте сезонные факторы
4. Настраивайте процент излишка под вашу практику

### Для производительности

1. Используйте формат .xlsx для больших файлов
2. Разбивайте большие наборы данных на части
3. Настраивайте параметры производительности в конфигурации

### Для безопасности

1. Регулярно создавайте резервные копии настроек
2. Храните конфиденциальные данные в защищенном месте
3. Используйте надежные пароли для баз данных

## Поддержка и обратная связь

При возникновении проблем или предложений по улучшению системы:

1. Проверьте документацию и логи
2. Обратитесь к системному администратору
3. Создайте issue в системе отслеживания ошибок
4. Свяжитесь с разработчиком системы

## Приложения

### A. Примеры данных

В директории [examples/](file:///c%3A/Users/D_909/Desktop/%D0%B4%D0%BB%D1%8F%20%D0%BD%D0%BE%D0%B2%D0%BE%D0%B3%D0%BE%20%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0/examples/) находятся примеры файлов данных для тестирования.

### B. Горячие клавиши

#### Flet GUI
- Ctrl+O - Открыть файл
- Ctrl+R - Запустить расчет
- Ctrl+Q - Выход

#### Tkinter GUI
- Ctrl+O - Открыть файл
- Ctrl+R - Запустить расчет
- Ctrl+Q - Выход

### C. Термины и определения

- **Усушка** - Естественная потеря массы товара при хранении
- **Коэффициент усушки** - Процент потери массы за единицу времени
- **Адаптивная модель** - Самообучающаяся модель, учитывающая внешние факторы
- **Инвентаризация** - Процедура подсчета фактического количества товара