# Сводка по анализу данных инвентаризации и определению усушки

## Ключевые принципы работы системы

### 1. Источник данных
Система работает с **документами инвентаризации**, которые содержат информацию о **недостачах**, выявленных по результатам инвентаризации. Важно понимать, что:

- Причины недостач могут быть разные: усушка, утеря товара, порча и другие факторы
- Сами документы инвентаризации **не содержат** информацию о применении принципа FIFO
- Принцип FIFO применяется системой при анализе движения партий

### 2. Анализ недостач
Система **анализирует** информацию о недостачах из документов инвентаризации для определения:
- Какая часть недостач связана с усушкой
- Какая часть недостач связана с другими причинами (утеря, порча и т.д.)

### 3. Расчет коэффициентов усушки
На основе анализа недостач система рассчитывает коэффициенты усушки по формуле:
```
S(t) = a * (1 - exp(-b*t)) + c*t
```

Где:
- `S(t)` - усушка в долях от начального остатка на момент времени `t`
- `t` - время хранения в днях
- `a`, `b`, `c` - коэффициенты модели

## Процесс обработки данных

1. **Загрузка данных** из Excel файлов инвентаризации
2. **Валидация структуры** данных
3. **Извлечение информации о недостачах** из инвентаризаций
4. **Анализ причин недостач** (усушка vs другие причины)
5. **Определение типа продукции**
6. **Расчет коэффициентов усушки** на основе данных о реальных недостачах
7. **Адаптация коэффициентов** на основе исторических данных
8. **Формирование отчетов**

## Особенности анализа

### Разделение причин недостач
Система использует адаптивные модели машинного обучения для разделения недостач на:
- Недостачи, связанные с усушкой
- Недостачи, связанные с другими причинами (утеря, порча и т.д.)

### Учет излишков
Система учитывает возможные излишки при поступлении продукции, которые могут влиять на анализ недостач.

### Адаптивные модели
Для повышения точности определения усушки среди других причин недостач система использует адаптивные модели, которые корректируют коэффициенты на основе:
- Типа продукции
- Внешних факторов (температура, влажность)
- Сезонных колебаний
- Исторических данных

## Типы продукции

Система различает следующие типы рыбопродуктов:
1. Свежая рыба (fish_fresh)
2. Слабосоленая рыба (fish_salt_cured)
3. Холодное копчение (fish_cold_smoked)
4. Горячее копчение (fish_hot_smoked)
5. Копченая рыба (fish_smoked)
6. Сушеная/вяленая рыба (fish_dried)

Для каждого типа применяются индивидуальные коэффициенты и модели анализа.

## Важные замечания

1. **Система не рассчитывает усушку по балансам** - она анализирует уже имеющиеся данные о недостачах
2. **FIFO применяется системой**, а не содержится в документах инвентаризации
3. **Анализ причин недостач** - ключевая функция системы
4. **Адаптивные модели** позволяют улучшать точность определения усушки со временем